20260114 23:57:48 - MainProcess | MainThread | pdf_parser.parse_pdf:53 - DEBUG - [pdf解析之后的文本内容]：
 Test Data
This dataset contains two test samples provided by ChatGPT, an AI language model by OpenAI.
These samples include a markdown table and an English text passage, which can be used to test an
English-to-Chinese translation software supporting both text and table formats.
Text testing
The quick brown fox jumps over the lazy dog. This pangram contains every letter of the English
alphabet at least once. Pangrams are often used to test fonts, keyboards, and other text-related
tools. In addition to English, there are pangrams in many other languages. Some pangrams are more
difficult to construct due to the unique characteristics of the language.
Table Testing
20260114 23:57:48 - MainProcess | MainThread | pdf_parser.parse_pdf:58 - DEBUG - [pdf解析之后的表格内容：]
<model.content.TableContent object at 0x116d4c590>
20260114 23:57:49 - MainProcess | MainThread | translator_chain.run:48 - ERROR - Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-proj-**************************************************************************************************************************************************Cn5-. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'code': 'invalid_api_key', 'param': None}, 'status': 401}
Traceback (most recent call last):

  File "/Users/gutao/PycharmProjects/LangChain_BookTranslator/main.py", line 20, in <module>
    translator.translate_book(file_path=config.input_file, source_language=config.source_language, target_language=config.target_language, out_file_format=config.file_format)
    │          │                        │                                  │                                       │                                       └ <utils.project_config.ProjectConfig object at 0x116344050>
    │          │                        │                                  │                                       └ <utils.project_config.ProjectConfig object at 0x116344050>
    │          │                        │                                  └ <utils.project_config.ProjectConfig object at 0x116344050>
    │          │                        └ <utils.project_config.ProjectConfig object at 0x116344050>
    │          └ <function PDFTranslator.translate_book at 0x116650040>
    └ <translator.book_translator.PDFTranslator object at 0x116345550>

  File "/Users/gutao/PycharmProjects/LangChain_BookTranslator/translator/book_translator.py", line 43, in translate_book
    translation_text, status = self.chain.run(content, source_language, target_language)
                               │    │     │   │        │                └ 'Japanese'
                               │    │     │   │        └ 'English'
                               │    │     │   └ <model.content.Content object at 0x116d4d160>
                               │    │     └ <function TranslatorChain.run at 0x116650220>
                               │    └ <translator.translator_chain.TranslatorChain object at 0x1163457f0>
                               └ <translator.book_translator.PDFTranslator object at 0x116345550>

> File "/Users/gutao/PycharmProjects/LangChain_BookTranslator/translator/translator_chain.py", line 41, in run
    result = self.langchain.invoke({
             │    │         └ <function RunnableSequence.invoke at 0x10f66ca40>
             │    └ ChatPromptTemplate(input_variables=['source_language', 'target_language', 'text'], input_types={}, partial_variables={}, mess...
             └ <translator.translator_chain.TranslatorChain object at 0x1163457f0>

  File "/Users/gutao/LangChain_BookTranslator/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config)
             │       │   │    │       │       └ {'tags': [], 'metadata': {}, 'callbacks': <langchain_core.callbacks.manager.CallbackManager object at 0x116d895e0>, 'recursio...
             │       │   │    │       └ ChatPromptValue(messages=[SystemMessage(content='"你是一个翻译专家，精通各种人类语言。\n\n        输入的是：English语言，翻译之后的语言为：Japanese\n        ', ...
             │       │   │    └ <function BaseChatModel.invoke at 0x1150fb600>
             │       │   └ ChatOpenAI(profile={'max_input_tokens': 128000, 'max_output_tokens': 16384, 'image_inputs': True, 'audio_inputs': False, 'vid...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x116ed6ec0>
  File "/Users/gutao/LangChain_BookTranslator/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    │    └ <function BaseChatModel.generate_prompt at 0x1150fbc40>
    └ ChatOpenAI(profile={'max_input_tokens': 128000, 'max_output_tokens': 16384, 'image_inputs': True, 'audio_inputs': False, 'vid...
  File "/Users/gutao/LangChain_BookTranslator/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           │    │        │                     │               │            └ {'tags': [], 'metadata': {}, 'run_name': None, 'run_id': None}
           │    │        │                     │               └ <langchain_core.callbacks.manager.CallbackManager object at 0x116d1f1e0>
           │    │        │                     └ None
           │    │        └ [[SystemMessage(content='"你是一个翻译专家，精通各种人类语言。\n\n        输入的是：English语言，翻译之后的语言为：Japanese\n        ', additional_kwargs={}, re...
           │    └ <function BaseChatModel.generate at 0x1150fbb00>
           └ ChatOpenAI(profile={'max_input_tokens': 128000, 'max_output_tokens': 16384, 'image_inputs': True, 'audio_inputs': False, 'vid...
  File "/Users/gutao/LangChain_BookTranslator/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    │    └ <function BaseChatModel._generate_with_cache at 0x1150fbd80>
    └ ChatOpenAI(profile={'max_input_tokens': 128000, 'max_output_tokens': 16384, 'image_inputs': True, 'audio_inputs': False, 'vid...
  File "/Users/gutao/LangChain_BookTranslator/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
             │    └ <function BaseChatOpenAI._generate at 0x1151927a0>
             └ ChatOpenAI(profile={'max_input_tokens': 128000, 'max_output_tokens': 16384, 'image_inputs': True, 'audio_inputs': False, 'vid...
  File "/Users/gutao/LangChain_BookTranslator/lib/python3.13/site-packages/langchain_openai/chat_models/base.py", line 1386, in _generate
    raise e
  File "/Users/gutao/LangChain_BookTranslator/lib/python3.13/site-packages/langchain_openai/chat_models/base.py", line 1381, in _generate
    raw_response = self.client.with_raw_response.create(**payload)
                   │    │      │                 │        └ {'model': 'gpt-4o', 'stream': False, 'temperature': 0.0, 'messages': [{'content': '"你是一个翻译专家，精通各种人类语言。\n\n        输入的是：Englis...
                   │    │      │                 └ <function Completions.create at 0x116d3bb00>
                   │    │      └ <openai.resources.chat.completions.completions.CompletionsWithRawResponse object at 0x116d4dbe0>
                   │    └ <openai.resources.chat.completions.completions.Completions object at 0x1166f6900>
                   └ ChatOpenAI(profile={'max_input_tokens': 128000, 'max_output_tokens': 16384, 'image_inputs': True, 'audio_inputs': False, 'vid...
  File "/Users/gutao/LangChain_BookTranslator/lib/python3.13/site-packages/openai/_legacy_response.py", line 364, in wrapped
    return cast(LegacyAPIResponse[R], func(*args, **kwargs))
           │    │                 │   │     │       └ {'model': 'gpt-4o', 'stream': False, 'temperature': 0.0, 'messages': [{'content': '"你是一个翻译专家，精通各种人类语言。\n\n        输入的是：Englis...
           │    │                 │   │     └ ()
           │    │                 │   └ <bound method Completions.create of <openai.resources.chat.completions.completions.Completions object at 0x1166f6900>>
           │    │                 └ ~R
           │    └ <class 'openai._legacy_response.LegacyAPIResponse'>
           └ <function cast at 0x10b86d4e0>
  File "/Users/gutao/LangChain_BookTranslator/lib/python3.13/site-packages/openai/_utils/_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
           │     │       └ {'model': 'gpt-4o', 'stream': False, 'temperature': 0.0, 'messages': [{'content': '"你是一个翻译专家，精通各种人类语言。\n\n        输入的是：Englis...
           │     └ (<openai.resources.chat.completions.completions.Completions object at 0x1166f6900>,)
           └ <function Completions.create at 0x116828680>
  File "/Users/gutao/LangChain_BookTranslator/lib/python3.13/site-packages/openai/resources/chat/completions/completions.py", line 1192, in create
    return self._post(
           │    └ <bound method SyncAPIClient.post of <openai.OpenAI object at 0x1166f41a0>>
           └ <openai.resources.chat.completions.completions.Completions object at 0x1166f6900>
  File "/Users/gutao/LangChain_BookTranslator/lib/python3.13/site-packages/openai/_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
           │    │          │    │       │        │            │                  └ openai.Stream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
           │    │          │    │       │        │            └ False
           │    │          │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers={'X-Stainless-Raw-Response': 'true'}, max_retr...
           │    │          │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
           │    │          │    └ <function SyncAPIClient.request at 0x114f4cc20>
           │    │          └ <openai.OpenAI object at 0x1166f41a0>
           │    └ ~ResponseT
           └ <function cast at 0x10b86d4e0>
  File "/Users/gutao/LangChain_BookTranslator/lib/python3.13/site-packages/openai/_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x114f43380>
          └ <openai.OpenAI object at 0x1166f41a0>

openai.AuthenticationError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-proj-**************************************************************************************************************************************************Cn5-. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'code': 'invalid_api_key', 'param': None}, 'status': 401}
20260114 23:57:49 - MainProcess | MainThread | book_translator.translate_book:45 - DEBUG - 翻译之后的文本：
 
20260114 23:57:49 - MainProcess | MainThread | content.sst_translation:41 - WARNING - 当前翻译之后的文本内容，不是字符串，请检查
20260114 23:57:49 - MainProcess | MainThread | translator_chain.run:39 - INFO - +++++++++++++++++++++++++++
20260114 23:57:49 - MainProcess | MainThread | translator_chain.run:48 - ERROR - Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-proj-**************************************************************************************************************************************************Cn5-. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'code': 'invalid_api_key', 'param': None}, 'status': 401}
Traceback (most recent call last):

  File "/Users/gutao/PycharmProjects/LangChain_BookTranslator/main.py", line 20, in <module>
    translator.translate_book(file_path=config.input_file, source_language=config.source_language, target_language=config.target_language, out_file_format=config.file_format)
    │          │                        │                                  │                                       │                                       └ <utils.project_config.ProjectConfig object at 0x116344050>
    │          │                        │                                  │                                       └ <utils.project_config.ProjectConfig object at 0x116344050>
    │          │                        │                                  └ <utils.project_config.ProjectConfig object at 0x116344050>
    │          │                        └ <utils.project_config.ProjectConfig object at 0x116344050>
    │          └ <function PDFTranslator.translate_book at 0x116650040>
    └ <translator.book_translator.PDFTranslator object at 0x116345550>

  File "/Users/gutao/PycharmProjects/LangChain_BookTranslator/translator/book_translator.py", line 43, in translate_book
    translation_text, status = self.chain.run(content, source_language, target_language)
    │                          │    │     │   │        │                └ 'Japanese'
    │                          │    │     │   │        └ 'English'
    │                          │    │     │   └ <model.content.TableContent object at 0x116d4c590>
    │                          │    │     └ <function TranslatorChain.run at 0x116650220>
    │                          │    └ <translator.translator_chain.TranslatorChain object at 0x1163457f0>
    │                          └ <translator.book_translator.PDFTranslator object at 0x116345550>
    └ ''

> File "/Users/gutao/PycharmProjects/LangChain_BookTranslator/translator/translator_chain.py", line 41, in run
    result = self.langchain.invoke({
             │    │         └ <function RunnableSequence.invoke at 0x10f66ca40>
             │    └ ChatPromptTemplate(input_variables=['source_language', 'target_language', 'text'], input_types={}, partial_variables={}, mess...
             └ <translator.translator_chain.TranslatorChain object at 0x1163457f0>

  File "/Users/gutao/LangChain_BookTranslator/lib/python3.13/site-packages/langchain_core/runnables/base.py", line 3151, in invoke
    input_ = context.run(step.invoke, input_, config)
             │       │   │    │       │       └ {'tags': [], 'metadata': {}, 'callbacks': <langchain_core.callbacks.manager.CallbackManager object at 0x116ee9b50>, 'recursio...
             │       │   │    │       └ ChatPromptValue(messages=[SystemMessage(content='"你是一个翻译专家，精通各种人类语言。\n\n        输入的是：English语言，翻译之后的语言为：Japanese\n        ', ...
             │       │   │    └ <function BaseChatModel.invoke at 0x1150fb600>
             │       │   └ ChatOpenAI(profile={'max_input_tokens': 128000, 'max_output_tokens': 16384, 'image_inputs': True, 'audio_inputs': False, 'vid...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x116ecb680>
  File "/Users/gutao/LangChain_BookTranslator/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 402, in invoke
    self.generate_prompt(
    │    └ <function BaseChatModel.generate_prompt at 0x1150fbc40>
    └ ChatOpenAI(profile={'max_input_tokens': 128000, 'max_output_tokens': 16384, 'image_inputs': True, 'audio_inputs': False, 'vid...
  File "/Users/gutao/LangChain_BookTranslator/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1121, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           │    │        │                     │               │            └ {'tags': [], 'metadata': {}, 'run_name': None, 'run_id': None}
           │    │        │                     │               └ <langchain_core.callbacks.manager.CallbackManager object at 0x116d62350>
           │    │        │                     └ None
           │    │        └ [[SystemMessage(content='"你是一个翻译专家，精通各种人类语言。\n\n        输入的是：English语言，翻译之后的语言为：Japanese\n        ', additional_kwargs={}, re...
           │    └ <function BaseChatModel.generate at 0x1150fbb00>
           └ ChatOpenAI(profile={'max_input_tokens': 128000, 'max_output_tokens': 16384, 'image_inputs': True, 'audio_inputs': False, 'vid...
  File "/Users/gutao/LangChain_BookTranslator/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 931, in generate
    self._generate_with_cache(
    │    └ <function BaseChatModel._generate_with_cache at 0x1150fbd80>
    └ ChatOpenAI(profile={'max_input_tokens': 128000, 'max_output_tokens': 16384, 'image_inputs': True, 'audio_inputs': False, 'vid...
  File "/Users/gutao/LangChain_BookTranslator/lib/python3.13/site-packages/langchain_core/language_models/chat_models.py", line 1233, in _generate_with_cache
    result = self._generate(
             │    └ <function BaseChatOpenAI._generate at 0x1151927a0>
             └ ChatOpenAI(profile={'max_input_tokens': 128000, 'max_output_tokens': 16384, 'image_inputs': True, 'audio_inputs': False, 'vid...
  File "/Users/gutao/LangChain_BookTranslator/lib/python3.13/site-packages/langchain_openai/chat_models/base.py", line 1386, in _generate
    raise e
  File "/Users/gutao/LangChain_BookTranslator/lib/python3.13/site-packages/langchain_openai/chat_models/base.py", line 1381, in _generate
    raw_response = self.client.with_raw_response.create(**payload)
                   │    │      │                 │        └ {'model': 'gpt-4o', 'stream': False, 'temperature': 0.0, 'messages': [{'content': '"你是一个翻译专家，精通各种人类语言。\n\n        输入的是：Englis...
                   │    │      │                 └ <function Completions.create at 0x116d3bb00>
                   │    │      └ <openai.resources.chat.completions.completions.CompletionsWithRawResponse object at 0x116d4dbe0>
                   │    └ <openai.resources.chat.completions.completions.Completions object at 0x1166f6900>
                   └ ChatOpenAI(profile={'max_input_tokens': 128000, 'max_output_tokens': 16384, 'image_inputs': True, 'audio_inputs': False, 'vid...
  File "/Users/gutao/LangChain_BookTranslator/lib/python3.13/site-packages/openai/_legacy_response.py", line 364, in wrapped
    return cast(LegacyAPIResponse[R], func(*args, **kwargs))
           │    │                 │   │     │       └ {'model': 'gpt-4o', 'stream': False, 'temperature': 0.0, 'messages': [{'content': '"你是一个翻译专家，精通各种人类语言。\n\n        输入的是：Englis...
           │    │                 │   │     └ ()
           │    │                 │   └ <bound method Completions.create of <openai.resources.chat.completions.completions.Completions object at 0x1166f6900>>
           │    │                 └ ~R
           │    └ <class 'openai._legacy_response.LegacyAPIResponse'>
           └ <function cast at 0x10b86d4e0>
  File "/Users/gutao/LangChain_BookTranslator/lib/python3.13/site-packages/openai/_utils/_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
           │     │       └ {'model': 'gpt-4o', 'stream': False, 'temperature': 0.0, 'messages': [{'content': '"你是一个翻译专家，精通各种人类语言。\n\n        输入的是：Englis...
           │     └ (<openai.resources.chat.completions.completions.Completions object at 0x1166f6900>,)
           └ <function Completions.create at 0x116828680>
  File "/Users/gutao/LangChain_BookTranslator/lib/python3.13/site-packages/openai/resources/chat/completions/completions.py", line 1192, in create
    return self._post(
           │    └ <bound method SyncAPIClient.post of <openai.OpenAI object at 0x1166f41a0>>
           └ <openai.resources.chat.completions.completions.Completions object at 0x1166f6900>
  File "/Users/gutao/LangChain_BookTranslator/lib/python3.13/site-packages/openai/_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
           │    │          │    │       │        │            │                  └ openai.Stream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
           │    │          │    │       │        │            └ False
           │    │          │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers={'X-Stainless-Raw-Response': 'true'}, max_retr...
           │    │          │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
           │    │          │    └ <function SyncAPIClient.request at 0x114f4cc20>
           │    │          └ <openai.OpenAI object at 0x1166f41a0>
           │    └ ~ResponseT
           └ <function cast at 0x10b86d4e0>
  File "/Users/gutao/LangChain_BookTranslator/lib/python3.13/site-packages/openai/_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x114f43380>
          └ <openai.OpenAI object at 0x1166f41a0>

openai.AuthenticationError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-proj-**************************************************************************************************************************************************Cn5-. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'code': 'invalid_api_key', 'param': None}, 'status': 401}
20260114 23:57:49 - MainProcess | MainThread | book_translator.translate_book:45 - DEBUG - 翻译之后的文本：
 
20260114 23:57:49 - MainProcess | MainThread | file_writer.save_book_markdown:102 - DEBUG - Markdown源文件路径：test/test.pdf，翻译后的文件路径：test/test_translated.md
20260114 23:57:49 - MainProcess | MainThread | file_writer.save_book_markdown:131 - INFO - Markdown文件写入完成！
